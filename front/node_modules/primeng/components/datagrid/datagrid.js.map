{"version":3,"file":"datagrid.js","sourceRoot":"","sources":["datagrid.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,qBAA4J,eAAe,CAAC,CAAA;AAC5K,uBAA2B,iBAAiB,CAAC,CAAA;AAC7C,uBAAqB,kBAAkB,CAAC,CAAA;AACxC,uBAAqB,kBAAkB,CAAC,CAAA;AACxC,0BAA8B,wBAAwB,CAAC,CAAA;AAyBvD;IAsCI,kBAAmB,EAAc,EAAE,OAAwB;QAAxC,OAAE,GAAF,EAAE,CAAY;QA5BxB,cAAS,GAAW,CAAC,CAAC;QAMrB,eAAU,GAAsB,IAAI,mBAAY,EAAE,CAAC;QAMpD,sBAAiB,GAAW,QAAQ,CAAC;QAUvC,UAAK,GAAW,CAAC,CAAC;QAElB,SAAI,GAAW,CAAC,CAAC;QAKpB,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;IAChD,CAAC;IAED,kCAAe,GAAf;QACI,EAAE,CAAA,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;YACX,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC;gBACjB,KAAK,EAAE,IAAI,CAAC,KAAK;gBACjB,IAAI,EAAE,IAAI,CAAC,IAAI;aAClB,CAAC,CAAC;QACP,CAAC;IACL,CAAC;IAED,4BAAS,GAAT;QACI,IAAI,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAE3C,EAAE,CAAA,CAAC,OAAO,CAAC,CAAC,CAAC;YACT,EAAE,CAAA,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;gBAChB,IAAI,CAAC,eAAe,EAAE,CAAC;YAC3B,CAAC;YACD,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACxC,CAAC;IACL,CAAC;IAED,kCAAe,GAAf;QACI,eAAe;QACf,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,YAAY,GAAG,CAAC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,GAAE,CAAC,CAAC,CAAC;QAExF,OAAO;QACP,EAAE,CAAA,CAAC,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC;YACtD,IAAI,aAAa,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,GAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC3D,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,aAAa,GAAC,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;QAC5D,CAAC;IACL,CAAC;IAED,2BAAQ,GAAR,UAAS,KAAK;QACV,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;QACzB,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC;QAEvB,EAAE,CAAA,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;YACX,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,sBAAsB,EAAE,CAAC,CAAC;QACxD,CAAC;QACD,IAAI,CAAC,CAAC;YACF,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACxC,CAAC;IACL,CAAC;IAED,qCAAkB,GAAlB,UAAmB,UAAU;QACzB,EAAE,CAAA,CAAC,IAAI,CAAC,SAAS,IAAI,UAAU,CAAC,CAAC,CAAC;YAC9B,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;YACvB,IAAI,UAAU,GAAG,IAAI,CAAC,IAAI,GAAG,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC;YAC5C,GAAG,CAAA,CAAC,IAAI,CAAC,GAAG,UAAU,EAAE,CAAC,GAAG,CAAC,UAAU,GAAE,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC;gBACvD,EAAE,CAAA,CAAC,CAAC,IAAI,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC;oBACxB,KAAK,CAAC;gBACV,CAAC;gBAED,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;YAC1C,CAAC;QACL,CAAC;QACD,IAAI,CAAC,CAAC;YACF,IAAI,CAAC,YAAY,GAAG,UAAU,CAAC;QACnC,CAAC;IACL,CAAC;IAED,0BAAO,GAAP;QACI,MAAM,CAAC,CAAC,IAAI,CAAC,YAAY,IAAE,CAAC,IAAI,CAAC,YAAY,CAAC,MAAM,IAAI,CAAC,CAAC,CAAC;IAC/D,CAAC;IAED,yCAAsB,GAAtB;QACI,MAAM,CAAC;YACH,KAAK,EAAE,IAAI,CAAC,KAAK;YACjB,IAAI,EAAE,IAAI,CAAC,IAAI;SAClB,CAAC;IACN,CAAC;IAED,sCAAmB,GAAnB;QACI,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;IAC7C,CAAC;IAjHD;QAAC,YAAK,EAAE;;2CAAA;IAER;QAAC,YAAK,EAAE;;+CAAA;IAER;QAAC,YAAK,EAAE;;0CAAA;IAER;QAAC,YAAK,EAAE;;kDAAA;IAER;QAAC,YAAK,EAAE;;+CAAA;IAER;QAAC,YAAK,EAAE;;wDAAA;IAER;QAAC,YAAK,EAAE;;0CAAA;IAER;QAAC,aAAM,EAAE;;gDAAA;IAET;QAAC,YAAK,EAAE;;2CAAA;IAER;QAAC,YAAK,EAAE;;gDAAA;IAER;QAAC,YAAK,EAAE;;uDAAA;IAER;QAAC,mBAAY,CAAC,eAAM,CAAC;;4CAAA;IAErB;QAAC,mBAAY,CAAC,eAAM,CAAC;;4CAAA;IAErB;QAAC,mBAAY,CAAC,kBAAW,CAAC;;kDAAA;IAlD9B;QAAC,gBAAS,CAAC;YACP,QAAQ,EAAE,YAAY;YACtB,QAAQ,EAAE,q5CAkBT;SACJ,CAAC;;gBAAA;IAqHF,eAAC;AAAD,CAAC,AApHD,IAoHC;AApHY,gBAAQ,WAoHpB,CAAA;AAOD;IAAA;IAA8B,CAAC;IAL/B;QAAC,eAAQ,CAAC;YACN,OAAO,EAAE,CAAC,qBAAY,EAAC,2BAAe,CAAC;YACvC,OAAO,EAAE,CAAC,QAAQ,CAAC;YACnB,YAAY,EAAE,CAAC,QAAQ,CAAC;SAC3B,CAAC;;sBAAA;IAC4B,qBAAC;AAAD,CAAC,AAA/B,IAA+B;AAAlB,sBAAc,iBAAI,CAAA","sourcesContent":["import {NgModule,Component,ElementRef,AfterViewInit,OnDestroy,DoCheck,Input,Output,SimpleChange,EventEmitter,ContentChild,IterableDiffers,TemplateRef} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {Header} from '../common/shared';\nimport {Footer} from '../common/shared';\nimport {PaginatorModule} from '../paginator/paginator';\nimport {BlockableUI} from '../common/api';\n\n@Component({\n    selector: 'p-dataGrid',\n    template: `\n        <div [ngClass]=\"'ui-datagrid ui-widget'\" [ngStyle]=\"style\" [class]=\"styleClass\">\n            <div class=\"ui-datagrid-header ui-widget-header ui-corner-top\" *ngIf=\"header\">\n                <ng-content select=\"header\"></ng-content>\n            </div>\n            <p-paginator [rows]=\"rows\" [first]=\"first\" [totalRecords]=\"totalRecords\" [pageLinkSize]=\"pageLinks\" \n                (onPageChange)=\"paginate($event)\" styleClass=\"ui-paginator-bottom\" [rowsPerPageOptions]=\"rowsPerPageOptions\" *ngIf=\"paginator && paginatorPosition!='bottom' || paginatorPosition =='both'\"></p-paginator>\n            <div class=\"ui-datagrid-content ui-widget-content\">\n                <div class=\"ui-g\">\n                    <template ngFor [ngForOf]=\"dataToRender\" [ngForTemplate]=\"itemTemplate\"></template>\n                </div>\n            </div>\n            <p-paginator [rows]=\"rows\" [first]=\"first\" [totalRecords]=\"totalRecords\" [pageLinkSize]=\"pageLinks\" \n                (onPageChange)=\"paginate($event)\" styleClass=\"ui-paginator-bottom\" [rowsPerPageOptions]=\"rowsPerPageOptions\" *ngIf=\"paginator && paginatorPosition!='top' || paginatorPosition =='both'\"></p-paginator>\n            <div class=\"ui-datagrid-footer ui-widget-header ui-corner-top\" *ngIf=\"footer\">\n                <ng-content select=\"footer\"></ng-content>\n            </div>\n        </div>\n    `\n})\nexport class DataGrid implements AfterViewInit,DoCheck,BlockableUI {\n\n    @Input() value: any[];\n\n    @Input() paginator: boolean;\n\n    @Input() rows: number;\n    \n    @Input() totalRecords: number;\n\n    @Input() pageLinks: number = 5;\n    \n    @Input() rowsPerPageOptions: number[];\n\n    @Input() lazy: boolean;\n    \n    @Output() onLazyLoad: EventEmitter<any> = new EventEmitter();\n\n    @Input() style: any;\n\n    @Input() styleClass: string;\n    \n    @Input() paginatorPosition: string = 'bottom';\n            \n    @ContentChild(Header) header;\n\n    @ContentChild(Footer) footer;\n    \n    @ContentChild(TemplateRef) itemTemplate: TemplateRef<any>;\n\n    public dataToRender: any[];\n\n    public first: number = 0;\n    \n    public page: number = 0;\n\n    differ: any;\n    \n    constructor(public el: ElementRef, differs: IterableDiffers) {\n        this.differ = differs.find([]).create(null);\n    }\n\n    ngAfterViewInit() {\n        if(this.lazy) {\n            this.onLazyLoad.emit({\n                first: this.first,\n                rows: this.rows\n            });\n        }\n    }\n    \n    ngDoCheck() {\n        let changes = this.differ.diff(this.value);\n\n        if(changes) {\n            if(this.paginator) {\n                this.updatePaginator();\n            }\n            this.updateDataToRender(this.value);\n        }\n    }\n    \n    updatePaginator() {\n        //total records\n        this.totalRecords = this.lazy ? this.totalRecords : (this.value ? this.value.length: 0);\n        \n        //first\n        if(this.totalRecords && this.first >= this.totalRecords) {\n            let numberOfPages = Math.ceil(this.totalRecords/this.rows);\n            this.first = Math.max((numberOfPages-1) * this.rows, 0);\n        }\n    }\n\n    paginate(event) {\n        this.first = event.first;\n        this.rows = event.rows;\n        \n        if(this.lazy) {\n            this.onLazyLoad.emit(this.createLazyLoadMetadata());\n        }\n        else {\n            this.updateDataToRender(this.value);\n        }\n    }\n\n    updateDataToRender(datasource) {\n        if(this.paginator && datasource) {\n            this.dataToRender = [];\n            let startIndex = this.lazy ? 0 : this.first;\n            for(let i = startIndex; i < (startIndex+ this.rows); i++) {\n                if(i >= datasource.length) {\n                    break;\n                }\n\n                this.dataToRender.push(datasource[i]);\n            }\n        }\n        else {\n            this.dataToRender = datasource;\n        }\n    }\n\n    isEmpty() {\n        return !this.dataToRender||(this.dataToRender.length == 0);\n    }\n    \n    createLazyLoadMetadata(): any {\n        return {\n            first: this.first,\n            rows: this.rows\n        };\n    }\n    \n    getBlockableElement(): HTMLElementÂ {\n        return this.el.nativeElement.children[0];\n    }\n}\n\n@NgModule({\n    imports: [CommonModule,PaginatorModule],\n    exports: [DataGrid],\n    declarations: [DataGrid]\n})\nexport class DataGridModule { }\n"]}